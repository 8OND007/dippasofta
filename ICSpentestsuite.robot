***Settings***
Library         Process
Library         ./NVDsearch.py
Library         ./profinet_scanner.py
Library         ./S7-1200-Workshop.py

***Variables***
${TARGET}           Profinet
${WAITTIME}         2
${ETH_INTERFACE}    enx0050b66b034c
${IP}               192.168.250.129

***Test Cases***
# Be noted that some of the used scripts need administrative priviledges to run.

#MyTestCase1                        
    #Search and display vulnerabilities
    #read_S7_1200_parameters             ${IP}
    #log     ${RESULT.stdout}
MyProfinetTestCase
#    Search and display vulnerabilities
    Scan for profinet devices


***Keywords***
Search and display vulnerabilities
    [Documentation]     Runs online search for vulnerabilities with given parameter.
    ...                 Opens website with two tabs, one for the search and one for statistics on that search.
    Search from NVD database    ${TARGET}


Scan for profinet devices
    [Documentation]     Runs PROFINET scanner and prints results to log file and console.
    ...                 Note: Needs administrative priviledges to run.
    Run Profinet scanner as module


Run Profinet scanner as module
    [Documentation]     Runs PROFINET scanner as a python module.
    ...                 Logs
    ${resultDict}=      run_profinet_scanner          ${ETH_INTERFACE}
    log_results         ${resultDict}       ${TRUE}

Run Profinet scanner externally
    [Documentation]     Runs PROFINET scanner as an external program like from commandprompt.
    ...                 Logs the output at WARN level to output stdout to both log and console.
    Start Process      python  ./profinet_scanner.py        -i ${ETH_INTERFACE}
    ${result}   Wait For Process    timeout=${WAITTIME}      on_timeout=terminate
    Should be equal as integers     ${result.rc}    0
    log     ${result.stdout}       WARN    


