***Settings***
Library         Process
Library         ./NVDsearch.py

***Variables***
${TARGET}           Profinet
${WAITTIME}         5
${ETH_INTERFACE}    enx0050b66b034c

***Test Cases***
# Be noted that some of the used scripts need administrative priviledges to run.

#MyTestCase1                        
#    Search and display vulnerabilities

MyProfinetTestCase
    Search and display vulnerabilities
    #Scan for profinet devices


***Keywords***
Search and display vulnerabilities
    [Documentation]     Runs online search for vulnerabilities with given parameter.
    ...                 Opens website with two tabs, one for the search and one for statistics on that search.
    Search from NVD database    ${TARGET}

Scan for profinet devices
    [Documentation]     Runs PROFINET scanner and prints results to log file and console.
    ...                 Note: Needs administrative priviledges to run.
    Start Process      python  ./profinet_scanner.py        -i ${ETH_INTERFACE}
    ${result}   Wait For Process    timeout=${WAITTIME}      on_timeout=terminate
    Should be equal as integers     ${result.rc}    0
    log     ${result.stdout}       WARN    


